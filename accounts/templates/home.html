{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cycle.in - Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

  <style>
    body {background-color: #fff;}
    header, .navbar, footer {background-color: #ffeb3b;}
    .product-card {border-radius: 12px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);}
    .btn-yellow {background-color: #ffeb3b; color: #000; border:none;}
    .btn-yellow:hover {background-color:#fdd835;}
    .reviews-scroll {display:flex; overflow-x:auto; gap:1rem; scroll-behavior:smooth;}
    .reviews-scroll::-webkit-scrollbar {display:none;}
    .footer-section {padding:2rem; background:#f9f9f9;}
   @media (max-width: 576px) {
  .navbar .form-control {
    font-size: 14px;
  }
  .navbar .btn {
    font-size: 14px;
    padding: 4px 8px;
  }
}

.category-img {
  width: 100px;
  height: 100px;
  object-fit: cover;
  border-radius: 50%;
  border: 2px solid #ddd;
  transition: transform 0.2s;
}
.category-img:hover {
  transform: scale(1.05);
  border-color: #ffeb3b;
}

/* Base animation style */
.scroll-animate {
  opacity: 0;
  transition: all 0.8s ease-out;
}

/* Left to right */
.scroll-left {
  transform: translateX(-60px);
}
.scroll-left.show {
  opacity: 1;
  transform: translateX(0);
}

/* Right to left */
.scroll-right {
  transform: translateX(60px);
}
.scroll-right.show {
  opacity: 1;
  transform: translateX(0);
}

/* --- Responsive Fix --- */
@media (max-width: 576px) {
  .scroll-left,
  .scroll-right {
    transform: translateY(40px);   /* move up/down instead of side */
  }
  .scroll-left.show,
  .scroll-right.show {
    transform: translateY(0);
  }
}

/* Loading overlay */
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(255,255,255,0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      display: none; /* hidden by default */
    }

    /* Show dropdown on hover */
    .dropdown:hover .dropdown-menu {
      display: block;
      margin-top: 0; /* keeps it directly below the button */
    }

    body {
    overflow-x: hidden;
}

  </style>

{% block style %}{% endblock style %}
</head>
<body>

<div class="loading-overlay" id="loadingOverlay">
  <div class="spinner-border text-warning" style="width: 4rem; height: 4rem;" role="status">
    <span class="visually-hidden">Loading...</span>
  </div>
</div>


<nav class="navbar navbar-expand-lg navbar-light" style="background-color: #ffeb3b;">
  <div class="container-fluid">

    <!-- Logo -->
    <a class="navbar-brand d-flex align-items-center loading-btn" href="{% url 'dashboard' %}">
      <img src="{% static 'logo.png' %}" alt="Logo" style="height:40px;">
    </a>

    <!-- Mobile toggle button -->
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNavbar"
      aria-controls="mainNavbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="mainNavbar">

      <!-- Centered search (takes all available space) -->
      <form class="d-flex flex-grow-1 mx-lg-3 my-2 my-lg-0">
        <input class="form-control me-2" type="search" placeholder="Search products..." aria-label="Search">
        <button class="btn btn-yellow" type="submit">Search</button>
      </form>

      <!-- Right buttons -->
      <div class="dropdown">
        <a class="btn btn-sm btn-yellow d-flex align-items-center dropdown-toggle"
          href="#" id="productsMenu" role="button"
          data-bs-toggle="dropdown" aria-expanded="false" title="Products">
          <i class="bi bi-grid"></i>
        </a>
        <ul class="dropdown-menu" id="productsDropdown" aria-labelledby="productsMenu">
          <li><span class="dropdown-item text-muted">Loading...</span></li>
        </ul>
      </div>

        <a class="btn btn-sm btn-yellow loading-btn" href="{% url 'profile' %}" title="Account">
          <i class="bi bi-person-circle"></i>
        </a>
        <a class="btn btn-sm btn-yellow loading-btn" href="{% url 'cart' %}" title="Cart">
          <i class="bi bi-cart"></i>
        </a>
        <a class="btn btn-sm btn-yellow loading-btn" href="{% url 'favourites' %}" title="Favourites">
          <i class="bi bi-heart"></i>
        </a>
        {% if user.is_authenticated %}
          <a href="{% url 'logout' %}" class="btn btn-sm btn-yellow loading-btn" title="Logout">
            <i class="bi bi-box-arrow-right"></i> <!-- logout icon -->
          </a>
        {% else %}
          <a class="btn btn-sm btn-yellow loading-btn" href="{% url 'login' %}">Login</a>
        {% endif %}
      </div>

    </div>
  </div>
</nav>

<!-- Toast Container -->
<div class="position-fixed top-0 end-0 p-3" style="z-index: 1100">
  {% if messages %}
    {% for message in messages %}
      <div class="toast align-items-center text-bg-success border-0 show" role="alert" aria-live="assertive" aria-atomic="true" data-bs-delay="2000">
        <div class="d-flex">
          <div class="toast-body">
            {{ message }}
          </div>
          <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
      </div>
    {% endfor %}
  {% endif %}
</div>


{% block content %}{% endblock %}



<!-- FOOTER -->
<footer>
  <div class="footer-section">
    <div class="row">
      <div class="col-md-3">
        <h5>About Us</h5>
        <p>Sri Sakthi Aromatic</p>
        <p style="font-size:11px;">
We are manufacturers of Cup sambrani, Sambrani Powder, TT Katti Sambrani, Incense cones, Agarbatties and other Pooja products.

We have been in the industry for the past 30+ years and counting. Our registered brands Sevalkodi, Ecstasy, Sai Shree and other brands like Sai Rudhra, Marugan, Chennai TT, Thennai TT, Sai Globe define our legacy selling through offline and online through various platforms.</p>
      </div>
      <div class="col-md-3">
        <h5>Policies</h5>
        <ul class="list-unstyled">
          <li><a href="#">Return Policy</a></li>
          <li><a href="#">Shipping Policy</a></li>
          <li><a href="#">Privacy Policy</a></li>
        </ul>
      </div>
      <div class="col-md-3">
        <h5>Quick Links</h5>
        <ul class="list-unstyled">
          <li><a href="#">Contact Us</a></li>
          <li><a href="#">FAQs</a></li>
          <li><a href="#">Brands</a></li>
        </ul>
      </div>
      <div class="col-md-3">
        <h5>Newsletter</h5>
        <form>
          <input type="email" class="form-control mb-2" placeholder="Enter email">
          <button class="btn btn-yellow btn-sm">Subscribe</button>
        </form>
      </div>
    </div>
  </div>
  <div class="text-center py-3" style="background:#ffeb3b;">
    ©2025 cycle.in
  </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const elements = document.querySelectorAll(".scroll-animate");

    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add("show");   // fade in when visible
        } else {
          entry.target.classList.remove("show"); // fade out when leaving
        }
      });
    }, { threshold: 0.2 });

    elements.forEach(el => observer.observe(el));
  });
</script>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const overlay = document.getElementById("loadingOverlay");

    // For all forms
    document.querySelectorAll("form").forEach(form => {
      form.addEventListener("submit", function (e) {
        e.preventDefault();
        overlay.style.display = "flex";
        setTimeout(() => form.submit(), 1000); // delay 1s
      });
    });

    // For all buttons/links with class="loading-btn"
    document.querySelectorAll(".loading-btn").forEach(btn => {
      btn.addEventListener("click", function (e) {
        overlay.style.display = "flex";
        // small delay so animation is visible before navigation
        setTimeout(() => {
          if (btn.tagName === "A" && btn.href) {
            window.location.href = btn.href;
          }
        }, 2000);
      });
    });
  });
</script>

<script>
document.addEventListener('DOMContentLoaded', function () {
  const toastElList = [].slice.call(document.querySelectorAll('.toast'));
  toastElList.forEach(function (toastEl) {
    new bootstrap.Toast(toastEl).show();
  });
});
</script>

<script>
document.addEventListener("DOMContentLoaded", function() {
    fetch("{% url 'menu_list_json' %}")
        .then(response => response.json())
        .then(data => {
            const dropdown = document.getElementById('productsDropdown');
            dropdown.innerHTML = '';

            if (data.menus.length === 0) {
                dropdown.innerHTML = '<li><span class="dropdown-item text-muted">No categories</span></li>';
                return;
            }

            data.menus.forEach(menu => {
                const li = document.createElement('li');
                if (menu.children.length > 0) {
                    li.classList.add('dropend'); // Bootstrap submenu to the right
                    li.innerHTML = `
                        <a class="dropdown-item dropdown-toggle" href="{% url 'products' %}?category=${menu.id}" data-bs-toggle="dropdown">
                            ${menu.name}
                        </a>
                        <ul class="dropdown-menu">
                            ${menu.children.map(child => `<li><a class="dropdown-item" href="{% url 'products' %}?category=${child.id}">${child.name}</a></li>`).join('')}
                        </ul>
                    `;
                } else {
                    li.innerHTML = `<a class="dropdown-item" href="{% url 'products' %}?category=${menu.id}">${menu.name}</a>`;
                }
                dropdown.appendChild(li);
            });
        })
        .catch(err => {
            console.error(err);
            const dropdown = document.getElementById('productsDropdown');
            dropdown.innerHTML = '<li><span class="dropdown-item text-danger">Failed to load menus</span></li>';
        });
});
</script>




</body>
</html>
